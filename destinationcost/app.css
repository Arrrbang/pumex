/* ========================================================================== */
/* 0) 토큰 (색/간격/레이어) — styles(22).css 톤 유지 + 변수 중복 정리               */
/*    - 중복된 --gutter, --header-h, shell 관련 변수 통합                         */
/*    - 디자인 변경 없이 변수만 정리                                              */
/* ========================================================================== */
:root{
  /* 기본 배경/전경 */
  --bg: #0b0f14;               /* 전체 배경 기본색 */
  --fg: #eef2f7;               /* 기본 텍스트 컬러 */
  --muted: #cbd5e1;            /* 보조 텍스트 컬러 */
  --btn-radius: 12px;          /* 버튼/요약바 공통 반경 */

  /* 브랜드/선/표면 */
  --primary: #1F9461;          /* 메인 포인트 컬러 */
  --border: rgba(255,255,255,0.18); /* 유리패널 테두리 */
  --surface: rgba(255,255,255,0.06);/* 유리패널 배경 */

  /* 레이아웃 */
  --header-h: 3rem;            /* 헤더 높이(고정) */
  --container-max: 1200px;     /* .container 최대폭 */
  --gutter: 1.25rem;           /* 좌우 여백 & 그리드 간격 */

  /* 폼 컨트롤 */
  --control-bg: #fff;          /* 입력 배경 */
  --control-fg: #333;          /* 입력 전경 */
  --control-border: rgba(105,130,100,0.3);   /* 드롭다운 입력 테두리 */
  --control-radius: .3rem;     /* 입력 모서리 */

  /* 표 */
  --table-header: #D1FAE5;     /* 선택 강조 배경 */
  --table-text:   #14532D;     /* 선택 강조 전경 */

  /* 배경 이미지/오버레이 (필요 시 변경) */
  --bg-image-url: none;
  --bg-overlay: linear-gradient(180deg, rgba(255,255,255,.40), rgba(255,255,255,.40));
  --bg-blur: 0px;
  --bg-darken: rgba(255,255,255,0);
}

/* ========================================================================== */
/* 1) 기본 구조 + 페이지 배경                                                     */
/* ========================================================================== */
*{ box-sizing: border-box; }
html{ font-size: clamp(14px, 1.2vw, 16px); }

body{
  padding-top: var(--header-h);             /* 헤더만큼 내림 */
  position: relative;
  background: #F2F5FA;                      /* 페이지 배경색 */
  min-height: calc(100dvh - var(--header-h));
}

/* 전체 배경 이미지/오버레이 끄기(본 페이지는 고정 컬러 배경) */
body::before,
body::after{
  content: none !important;
  display: none !important;
  background: none !important;
  filter: none !important;
  transform: none !important;
}

/* 공통 컨테이너 */
.container{ 
  max-width: var(--container-max); 
  margin: 0 auto; 
  padding-inline: var(--gutter); 
}

/* ========================================================================== */
/* 2) 상단 헤더 — styles(22).css 톤 복제                                          */
/* ========================================================================== */
.site-header{
  position: fixed; top:0; left:0; width:100%; z-index:999;
  background: #ffffff !important;                  /* 불투명 상단 바 */
  backdrop-filter: blur(12px);                     /* 분위기만 유지 */
  border-bottom: 1px solid rgba(0,0,0,.08) !important;
  height: var(--header-h);
  display: flex; align-items: center; text-align: left;
}

.site-header .logo img{
  height:2rem; display:block;
}

.site-header .container,
.site-header .header-inner {
  max-width: none; width: 100%; margin: 0;
  padding-left: 3rem; padding-right: var(--gutter);
  box-sizing: border-box;
  display: flex; justify-content: flex-start; align-items: center; gap: 12px;
}

.site-header .header-inner {
  justify-content: flex-start; align-items: center; gap: 12px;
}

.site-title {
  font-size: 1.3rem; font-weight: 800; color: #111;
  letter-spacing: 0.02em; margin-left: 12px; white-space: nowrap;
}

.nav-links a{ color: #334155 !important; }
.nav-links a:hover{ color: #000 !important; }

/* ========================================================================== */
/* 3) 앱 레이아웃: 좌(지도) / 우(폼)                                             */
/*    - .app-shell/.app-main 중복 선언 통합                                     */
/*    - 높이/폭/간격 속성 일원화                                                */
/* ========================================================================== */
.app-shell{
  background: transparent !important;   /* 중앙 컨테이너 배경 제거 */
  box-shadow: none !important;
  border: none !important;
  backdrop-filter: none !important;
  border-radius: 1rem;
  padding-top: var(--gutter);
  padding-right: var(--gutter);
  padding-bottom: var(--gutter);
  max-width: none !important;
  width: 90vw !important;               /* 전체폭의 90% */
  margin: 3rem auto 2rem auto !important;
  box-sizing: border-box;
  overflow: visible !important;
  transition: max-height .36s ease, opacity .24s ease;
  will-change: max-height, opacity;
  min-height: 43rem !important;            /* 고정 높이(내부 컨텐츠 기준) */
  height: auto !important
}
.app-shell.is-collapsing{ opacity: 0; } /* max-height는 JS 제어 */
.app-shell.is-collapsed{ display: none; }
.app-shell.is-expanding{ display: block; opacity: 1; }

/* 앱 메인 그리드 */
.app-main{
  display: grid !important;
  grid-template-columns: 7fr 3fr !important; /* left-pane과 right-pane의 비율 70% : 30% */
  gap: 3rem !important;                      /* left-pane과 right-pane사이의 간격 */
  align-items: stretch;
  width: 100% !important;
  height: 100% !important;           /* 자식 그리드가 셸 높이 채움 */
  min-height: inherit;
}

/* app-shell 내부 .container는 좌우 패딩 제거 */
.app-shell .container,
.app-shell .app-main.container{
  max-width: 100% !important;
  width: 100% !important;
  padding-left: 0;
  padding-right: 0;
}

/* 좌측/우측 패널 */
.pane-title {
  text-align: left;                /* 좌측 정렬 */
  margin-left: 0rem;               /* 왼쪽 여백 */
  font-size: 1.3rem;               /* 폰트 크기 */
  font-weight: 700;                /* Semi-bold */
  color: rgb(10, 10, 10);       /* 글자 색상 */
  margin-bottom: 1rem;             /* 글씨 하단 마진  */
}
.left-pane{
  overflow: hidden;
  height: 100% !important; 
}
.right-pane{
  justify-content: flex-start;
  align-items: stretch;
  min-height: 43rem !important;   /* 항상 최소 높이 확보 */
}

.left-pane,
.right-pane {
  background: #ffffff;                       /* 배경 흰색 */
  border: 1px solid var(--control-border);     /* 테두리 색상 및 두께 */
  border-radius: 0.8rem;                      /* 모서리 굴곡 */
  padding: 1.1rem 1.5rem 1.5rem;              /* 상 좌우 하 패딩 */
  box-shadow: none;                           /* 그림자 제거 */
  height: 100% !important;                            /* 높이 */
  box-sizing: border-box;                     /* 패딩 포함 계산 */
  display: flex;
  flex-direction: column;
}

/* ========================================================================== */
/* right pane 내부 버튼 (가격 조회, 가격 비교)                                    */
/* ========================================================================== */
.cost.button.container{
  width: 100%;                 /* combo-line과 동일 폭 */
  display: flex;               /* 한 줄에 두 버튼 */
  align-items: center;
  justify-content: center;     /* 가운데 정렬 (두 버튼이 중앙에 오도록) */
  gap: 2rem;                   /* 버튼 사이 간격 */
  padding-inline: 1rem;        /* 좌우 패딩 1rem */
  box-sizing: border-box;
  /* 필요 시 줄바꿈 방지 */
  flex-wrap: nowrap;
}

/* 공통 버튼 룩앤필 */
.cost-btn{
  flex: 1 1 0;
  background: var(--primary, #1F9461);
  color: #fff;
  font-weight: 700;
  font-size: 1rem;
  line-height: 1;
  border: 2px solid var(--primary, #1F9461);
  border-radius: 1rem;              /* 모서리 곡률 1rem */
  padding: .3rem 1rem;
  min-width: 9.5rem;                /* 텍스트 길이 균형용 */
  text-align: center;
  cursor: pointer;
  transition: background .18s ease, transform .06s ease, box-shadow .18s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;              /* 반드시 한 줄 유지 */
  margin-bottom : 1.5rem ;
}

/* 인터랙션 */
.cost-btn:hover{
  background: #16724a;              /* 살짝 진한 호버 */
  box-shadow: 0 4px 12px rgba(0,0,0,.12);
}
.cost-btn:active{
  transform: translateY(1px);
}

/* 접근성: 키보드 포커스 */
.cost-btn:focus-visible{
  outline: 3px solid rgba(31,148,97,.35);
  outline-offset: 2px;
}
/* ============================================================================
  비용 조회 버튼 관련 로직
   ========================================================================== */
#one-partner[hidden]{
  display: none !important;
  opacity: 0;
  pointer-events: none;
}
#cost-button-container[hidden]{
  display: none !important;
}
#one-partner{
  opacity: 1;
  transition: opacity 0.3s ease;
}
#one-partner[hidden]{
  display: block !important;    /* 자리 유지 (숨김상태에서도 공간 확보) */
  visibility: hidden;
  opacity: 0;
  pointer-events: none;
}
#one-partner:not([hidden]){
  visibility: visible;
  opacity: 1;
}
/* 지도 캔버스 */
.map-canvas{ 
  flex: 1 1 auto;
  position: relative; 
  width: 100% !important;
  height: 100% !important;   /* 기존 clamp 높이 대신 패널 채우기 */
  display: block;
  background:#0f1720; 
  border-radius: 0.3rem;              /* ✅ 모서리 굴곡 추가 */
  overflow: hidden;                   /* ✅ 둥근 모서리 바깥이 잘리도록 */
  min-height: 24rem;
  height: clamp(24rem, 60vh, 43rem);
}
.map-placeholder{
  position:absolute; inset:0; 
  display:flex; align-items:center; justify-content:center;
  color:#94a3b8; font-weight:600; letter-spacing:.02em;
  border:2px dashed rgba(148,163,184,.25); margin:12px; border-radius:0.5rem;
}

#mpkMap .leaflet-tile-pane{
  filter:
    invert(1)
    hue-rotate(185deg)
    saturate(1.2)     /* ✅ 1.35 → 1.2 (채도 살짝 낮춤) */
    brightness(1.60)  /* ✅ 0.92 → 1.05 (전체 밝기 조금 상승) */
    contrast(1.08);
  transform: translateZ(0); /* 크롬 렌더링 보정 */
}
#mpkMap::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:#d4dff3;     /* 군청색 */
  mix-blend-mode:multiply; /* 어두운 영역(바다) 강화 */
  opacity:.55;             /* 진하기 조절 (0.4~0.7 사이 조정) */
}

/* 대륙 톤 띄우기: 하늘색 오버레이를 screen으로 */
#mpkMap::before{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:#AEE6FF;      /* 하늘색 */
  mix-blend-mode:screen;   /* 밝은 영역(대륙) 띄우기 */
  opacity:.35;             /* 0.15~0.35 사이로 취향 조정 */
}

/* 접기/펼치기 애니메이션(선택) */
.app-shell.collapsing{ animation: shell-slide-up .28s ease forwards; }
.app-shell.expanding{  animation: shell-slide-down .32s ease forwards; }

/* ========================================================================== */
/* 4) 드롭다운/콤보 (ORI 스타일 유지 + placeholder 톤 통일)                      */
/* ========================================================================== */
.selection-summary{
  text-align:center; font-weight:700; color:#000; font-size:1.2rem;
  margin:.25rem 0 .75rem; opacity:.95;
}

/* 콤보/드롭다운 레이아웃 */
.dropdown-container{ 
  display:flex; flex-direction:column; gap:0.5rem; 
  margin-bottom: 1.5rem !important;
}
.combo-line{ width:100%; }

/* 드롭다운 카드(유리패널 톤) */
.dropdown{
  display:flex; flex-direction:column; gap:1rem; width:100%;
  background: rgba(255,255,255,0.82);
  border-radius: 0.5rem; 
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  backdrop-filter: blur(8px);
}
.dropdown-inner{ padding: 1rem 1.2rem; }

/* 라벨(가독성 색상 보정 + 누락된 세미콜론 보완) */
.dropdown-label{
  display:block; text-align:left;
  margin: 0 0 0;
  font-weight:600;
  color: rgba(50,50,50,0.75); 
  font-size:0.9rem;
  letter-spacing: 0.02em;
}

/* 네이티브 셀렉트/인풋 공통 */
.dropdown-select,
input[type="text"],
input[type="number"]{
  width:100%; padding:.6rem 1rem; font-size:1rem;
  border:1.5px solid var(--control-border); 
  border-radius: var(--control-radius);
  background: var(--control-bg); color: var(--control-fg);
}

/* placeholder/invalid 상태 통일 */
.combo input::placeholder,
.dropdown-select option[disabled][selected][hidden]{ color:#94a3b8 !important; }
.dropdown-select:invalid{ color:#94a3b8; }
.dropdown-select:not(:invalid){ color:#333; }

/* 커스텀 콤보 리스트 */
.combo{ position:relative; width:100%; }
.combo input{
  width:100%; padding:.6rem 1rem; font-size:1rem;
  border:1.5px solid var(--control-border); border-radius: var(--control-radius);
  background: var(--control-bg); color: var(--control-fg);
}
.combo .list{
  position:absolute; top: calc(100% + 6px); left:0; width:100%;
  max-height:240px; overflow:auto; background:#fff;
  border:2px solid var(--control-border); border-radius: var(--control-radius);
  box-shadow: 0 4px 12px rgba(0,0,0,.2);
  z-index:1000; display:none;                 /* focus/input 시 block */
}
.combo .list .item{ padding:.55rem .8rem; cursor:pointer; }
.combo .list .item:hover{ background: rgba(31,148,97,.08); }
.combo .list .item.is-selected{ background: var(--table-header); color: var(--table-text); }

/* 지도 액션 버튼(소형) */
.map-button-inline{
  background: var(--primary); color:#fff; font-weight:600; font-size:.9rem;
  padding:.2rem .6rem; border:none; border-radius:.4rem; cursor:pointer;
}
.map-button-inline:hover{ background:#16724a; }

/* 파트너 한 곳 비용 확인 컨테이너 */
.one partner {
  background: rgba(255, 255, 255, 0.82); /* 살짝 투명한 흰색 (기존 dropdown 톤 유지) */
  border: 1.5px solid var(--control-border);
  border-radius: 0.8rem;
  padding: 1.5rem 1.75rem;
  margin-bottom: 2rem;
  box-shadow: 0 4px 14px rgba(0,0,0,0.08);
  backdrop-filter: blur(6px);
  width: 100%;              /* ✅ 부모(우측 패널) 폭에 맞춤 */
  box-sizing: border-box;
}

/* 내부 라벨 정렬 개선 */
.one partner .dropdown-label {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.3rem;
}
/* ========================================================================== */
/* 5) 조회 버튼 & 결과 섹션                                                       */
/* ========================================================================== */
.action-row{                             /* 우측 정렬 액션 영역 */
  display:flex; justify-content:flex-end; margin:12px 0 0; /* 하단 0 */
}
.action-row.center{                      /* 중앙 정렬 액션 영역 */
  display:flex; justify-content:center; align-items:center; margin:2rem auto 0;
}

/* 기본 조회 버튼 */
.primary-btn {
  position: relative;                  /* 내부 아이콘(로딩 스피너 등) 위치 기준 */
  display: inline-flex;                /* 인라인 수준의 flex 컨테이너 */
  align-items: center;                 /* 세로 가운데 정렬 */
  justify-content: center;             /* 가로 가운데 정렬 */
  border-radius: 2rem;                 /* 모서리 둥글게 */
  padding: .2rem 1.25rem;              /* 상하 0.5rem, 좌우 1.25rem 여백 */
  min-width: 17rem;                    /* 최소 버튼 폭 */
  border: 2px solid var(--primary);    /* 버튼 테두리 색상 (메인 포인트 컬러) */
  background: var(--primary);          /* 배경색 (메인 포인트 컬러) */
  color: #fff;                         /* 글자색 흰색 */
  font-weight: 600;                    /* 폰트 두께: Bold */
  font-size: 1rem;                   /* ✅ 버튼 폰트 크기 */
  cursor: pointer;                     /* 클릭 가능한 커서 표시 */
  transition: background .2s ease, 
              transform .08s ease;     /* 배경색, 눌림 애니메이션 */
  text-align: center;                  /* 텍스트 가운데 정렬 */
}
.primary-btn:hover{ background:#16724a; }
.primary-btn:active{ transform: translateY(1px); }

/* 글자 시각적 중심 보정 */
.primary-btn span.label{ display:inline-block; transform: translateX(-4px); }
.primary-btn.is-loading span.label{ transform: translateX(4px); }

/* 로딩 스피너(왼쪽 아이콘 자리, 버튼 크기 불변) */
.primary-btn.is-loading{ cursor: progress; opacity: .96; }
.primary-btn.is-loading::before{
  content:""; position:absolute; left:10px; top:50%;
  width:16px; height:16px; margin-top:-8px;
  border: 2px solid rgba(255,255,255,.95); border-top-color: transparent;
  border-radius: 50%; animation: spin .8s linear infinite; pointer-events:none;
}

/* 결과 섹션 */
.result-section{ display:none; padding:.5rem 0 2rem; }
.result-section.show{ display:block; }
.result-container{ background: transparent !important; backdrop-filter: none !important; }
.table-wrap{ width:100%; overflow:auto; border-radius:inherit; }

/* 결과 표 */
.result-table{
  width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed;
  background:#fff; color:#111; border:none; border-radius: var(--control-radius);
  overflow:hidden; margin-top:8px;
}
.result-table th, .result-table td{
  border:1px solid #F5F5F5; padding:.6rem .75rem; text-align:left; vertical-align:top;
}
.result-table thead th{ background:#153A47; color:#F5F5F5; font-weight:700; }
.result-table tbody td:first-child{ background:#153A47; color:#F5F5F5; font-weight:700; text-align:center; }
.result-table thead th:first-child{ text-align:center; }
.result-table td.amt{ white-space:nowrap; text-align:center; font-variant-numeric: tabular-nums; }
/* 폭 튜닝: [항목 | 금액 | 비고] */
.result-table thead th:nth-child(1),
.result-table tbody td:nth-child(1){ width:20%; }
.result-table thead th:nth-child(2),
.result-table tbody td:nth-child(2){ width:10%; }
.result-table thead th:nth-child(3),
.result-table tbody td:nth-child(3){ width:auto; }
/* 2열 헤더/타입 헤더 가운데 정렬 */
.result-table thead th:nth-child(2),
.result-table thead th.type-col{ text-align:center; }

/* ========================================================================== */
/* 5-1) 요약 바 (접힌 상태 표시)                                                  */
/* ========================================================================== */
.collapsed-summary{
  position: sticky; top: var(--header-h); z-index: 10;
  display: flex; justify-content: center;
  background: transparent; border: 0; padding: .75rem 0 .5rem;
}
.collapsed-summary .container{
  display:flex; flex-direction:column; align-items:center; gap:.35rem;
  padding:.5rem .75rem; background:#0e1a2b;
  border: 1px solid rgba(255,255,255,.14);
  border-radius: var(--btn-radius);
  width: max-content; max-width: min(92vw, 75rem);
}
.collapsed-summary .chips{ display:flex; flex-wrap:wrap; gap:.5rem; align-items:center; justify-content:center; }
.collapsed-summary .chip{
  display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .6rem;
  border-radius:.75rem; cursor:pointer; background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.14); color:#e6edf5; font-weight:700; font-size:.95rem;
}
.collapsed-summary .chip .k{ opacity:.75; font-weight:600; }
.collapsed-summary .chip .v{ opacity:1; }
.collapsed-summary .chip:hover{ background: rgba(255,255,255,.12); }
.collapsed-summary .hint{ color:#a0b3ca; font-size:.85rem; opacity:.9; }

/* summary 표시/숨김 보정 */
#collapsedSummary[hidden]{ 
  display:none !important; visibility:hidden !important; height:0 !important;
  padding:0 !important; margin:0 !important; border:0 !important;
}
.collapsed-summary.reveal{ animation: sum-slide-down .28s ease both; }
#collapsedPanel{ display:block; }
#collapsedPanel .collapsed-summary .container{ display:flex; flex-direction:column; gap:12px; }
#collapsedPanel .result-section{ display:block; width:100%; margin-top:12px; }

/* ========================================================================== */
/* 6) 로딩 표시 (콤보/셀렉트)                                                     */
/* ========================================================================== */
.combo{ position: relative; }
.combo.is-loading input{ padding-left: 36px; } /* 왼쪽 스피너 여백 */
.combo.is-loading::after{
  content:""; position:absolute; left:10px; top:50%;
  width:16px; height:16px; margin-top:-8px;
  border: 2px solid currentColor; border-top-color: transparent;
  border-radius: 50%; opacity:.85; animation: spin .8s linear infinite; pointer-events:none;
}

/* 네이티브 <select> 로딩(선택사항): setSelectLoading(id, bool)로 토글 */
.dropdown-select.is-loading{
  position: relative; background-image: none !important; padding-left: 36px;
}
.dropdown-select.is-loading + .select-spinner{
  position: absolute; left:10px; top:50%; width:16px; height:16px; margin-top:-8px;
  border: 1.5px solid currentColor; border-top-color: transparent; border-radius: 50%;
  animation: spin 0.8s linear infinite; pointer-events: none;
}

/* 회전 애니메이션 */
@keyframes spin { to { transform: rotate(360deg); } }
/* (선택) app-shell 전환 애니메이션 키프레임 - JS에 맞춰 사용하세요
@keyframes shell-slide-up{ to{ opacity:0; transform: translateY(-8px);} }
@keyframes shell-slide-down{ from{ opacity:0; transform: translateY(-8px);} to{ opacity:1; transform: translateY(0);} }
@keyframes sum-slide-down{ from{ opacity:0; transform: translateY(-6px);} to{ opacity:1; transform: translateY(0);} }
*/

/* ========================================================================== */
/* 7) 반응형                                                                     */
/* ========================================================================== */
@media (max-width: 1024px){
  .app-main{
    grid-template-columns: 1fr !important;
    gap: 1.5rem !important;
  }
  .left-pane .map-canvas{
    min-height: 22rem;
    height: clamp(22rem, 55vh, 40rem);
  }
}
