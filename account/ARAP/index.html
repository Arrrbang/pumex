<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>해외 AGENT 미수금/미지급금</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="https://arrrbang.github.io/pumex/common/header/header.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="header-placeholder"></div>

<div class="main-layout">
    <div class="left-wrap">
        <div class="left-wrap-title">데이터 입력 & 저장</div>
        <div id="drop-zone">
            엑셀 파일을 여기에 드래그하거나<br>클릭하여 업로드하세요.
        </div>

        <div id="history-container">
            <h3 class="history-title">📂 저장된 파일 목록</h3>
            
            <ul id="history-list">
                <li class="empty-msg">저장된 내역이 없습니다.</li>
            </ul>

            <div class="history-btn-group">
                <button id="btn-save-current" onclick="saveCurrentData()">현재 파일 추가</button>
                <button id="btn-delete-selected" onclick="deleteSelectedHistory()">삭제</button>
            </div>
        </div>
    </div>

    <div class="vertical-divider"></div>

    <input type="file" id="fileInput" style="display: none;" />

    <div class="right-wrap">
        <div class="right-wrap-title">해외 AGENT 미수금/미지급금 파일 생성</div>

        <div id="global-loading-overlay">
            <div class="spinner"></div>
            <div class="loading-text">엑셀 파일 분석 중...</div>
        </div>

        <div class="control-panel" id="control-panel" style="display: none;">
            <select id="bound-filter" onchange="applyBoundFilter()">
                <option value="ALL">ALL BOUND</option>
                <option value="OUTBOUND">OUTBOUND</option>
                <option value="INBOUND">INBOUND</option>
            </select>

            <div class="btn-group">
                <button id="btn-save-pdf" onclick="saveAsPDF()">요약표 PDF 저장</button>
                <button id="btn-save-excel" onclick="saveAsExcel()">엑셀로 저장 (링크 포함)</button>
            </div>
        </div>
        <div id="result-area" style="display:none;">
            
            <div class="header-row-approval">
                <table class="approval-table">
                    <tr>
                        <td class="approval-title">담 당</td>
                        <td class="approval-title">팀 장</td>
                        <td class="approval-title">상무이사</td>
                        <td class="approval-title">대표이사</td>
                    </tr>
                    <tr>
                        <td class="approval-sign"></td>
                        <td class="approval-sign"></td>
                        <td class="approval-sign"></td>
                        <td class="approval-sign"></td>
                    </tr>
                </table>
            </div>

            <div class="header-row-title">
                <h2 id="main-title">해외 AGENT 미수금/미지급금</h2>
            </div>

            <div class="header-divider"></div>

            <div class="header-row-date">
                <span id="date-display">DATE : </span>
            </div>

                       
            <div id="table-content">
                <table id="main-table">
                    <thead>
                        <tr>
                            <th style="width: 35px;">NO</th>
                            <th style="width: 80px;" class="col-code">Code</th>
                            <th>업체명</th>
                            <th style="width: 45px;">건수</th>
                            <th style="width: 50px;">1달경과</th>
                            <th style="width: 50px;">1달이내</th>   
                            <th style="width: 35px;">CUR</th>
                            <th style="width: 85px;">CREDIT</th>
                            <th style="width: 85px;">DEBIT</th>
                            <th style="width: 90px;">BALANCE</th>
                            <th style="width: 150px;">비고 (Remarks)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div id="modal-overlay">
            <div id="modal-content">
                <span id="modal-close">&times;</span>
                <div class="modal-header-area">
                    <h3 id="modal-title">상세 내역</h3>
                    <button id="btn-modal-pdf" onclick="saveModalAsPDF()">이 내역 PDF 저장</button>
                </div>
                <table id="detail-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">BOUND</th>
                            <th style="width: 90px;">배송일</th>
                            <th style="width: 120px;">경과 시간</th>
                            <th>JOB NO(HBL)</th>
                            <th>CUR</th>
                            <th>DEBIT</th>
                            <th>CREDIT</th>
                            <th>BALANCE</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
    <script src="https://arrrbang.github.io/pumex/common/js/loading.js"></script>
    <script src="https://arrrbang.github.io/pumex/common/js/login.js"></script>
    <script src="pdf.js"></script>
    <script src="result.js"></script>
    <script src="excel.js"></script>
    <script src="history.js"></script>
</body>
</html>
